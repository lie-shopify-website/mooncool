<section data-section-id="{{ section.id }}" style="display:block;">
  <div class="container page-width {% if section.settings.full_width %}full-width{% endif %}" data-cc-animate="fade-in" data-cc-animate-delay="0.3s">
    {% if section.settings.title != blank or section.settings.sub_title != blank %}
    <div class="heading-title {% if section.settings.is_center %}text-center{% endif %}">
      {% if section.settings.title != blank %}<h2 class="title inline-richtext h2">{{ section.settings.title }}</h2>{% endif %}
      {% if section.settings.sub_title != blank %}<p class="sub-title">{{ section.settings.sub_title }}</p>{% endif %}
    </div>
    {% endif %}
    <div class="review-box">
        <div class="swiper">
            <div class="swiper-wrapper">
                {% for block in section.blocks %}
                    <div class="swiper-slide">
                      <a href="{{ block.settings.url }}">
                      <div class="image-wrapper">
                        {% if block.settings.image %}
                            <img src="{{ block.settings.image | image_url: width: 500 }}" width="500" height="auto" />
                        {% endif %}
                      </div>
                      <div class="review_star">
                          {% capture fullstar %}<svg xmlns="http://www.w3.org/2000/svg" class="full-star" viewBox="0 0 122.88 117.19" style="max-width:18px;"><path fill="{{ block.settings.rating_color }}" d="M64.39,2,80.11,38.76,120,42.33a3.2,3.2,0,0,1,1.83,5.59h0L91.64,74.25l8.92,39a3.2,3.2,0,0,1-4.87,3.4L61.44,96.19,27.09,116.73a3.2,3.2,0,0,1-4.76-3.46h0l8.92-39L1.09,47.92A3.2,3.2,0,0,1,3,42.32l39.74-3.56L58.49,2a3.2,3.2,0,0,1,5.9,0Z"/></svg>{% endcapture %}
                          {% capture halfstar %}<svg xmlns="http://www.w3.org/2000/svg" class="half-star" viewBox="0 0 512 489.217" style="max-width:18px;"><path fill="{{ block.settings.rating_color }}" fill-rule="nonzero" d="M278.41 15.832l59.521 139.378 152.968 13.689c6.245.682 11.71 3.801 15.512 8.326 3.833 4.52 5.956 10.445 5.537 16.752l-.082.966c-.92 9.22-5.067 12.81-10.171 17.221-37.832 32.769-75.441 65.864-113.148 98.789l34.123 149.31a23.635 23.635 0 01-3.012 17.826c-6.983 11.214-21.979 14.531-33.038 7.284l-130.623-78.111-131.443 78.586a23.6 23.6 0 01-17.899 2.655 23.638 23.638 0 01-14.546-10.822c-3.114-5.201-4.122-11.503-2.768-17.418l34.112-149.316L8.094 210.227a23.58 23.58 0 01-8.042-16.219 23.627 23.627 0 015.801-17.134c4.122-4.835 10.206-7.722 16.534-8.068l151.666-13.596L234.21 14.365c2.552-6.007 7.329-10.418 12.96-12.691 9.272-3.719 20.501-1.121 26.88 6.607 1.927 2.329 3.188 4.793 4.36 7.551zm-22.428 5.946v361.888a10.84 10.84 0 015.609 1.544l136.982 81.887c.186.124.429.223.687.264.625.274 1.57-.31 1.875-.796l.041-.041c.238-.382.336-.894.222-1.395l-35.574-155.654c-.847-3.781.341-7.898 3.461-10.63 39.371-34.381 78.638-68.948 118.143-103.169 1.436-1.245 2.614-2.257 2.707-3.058.083-1.054-.574-1.901-1.643-1.993l-158.355-14.252c-4.128-.124-8.002-2.588-9.722-6.632L258.337 24.376c-.418-.992-.795-1.782-1.115-2.17-.439-.247-.703-.439-1.24-.428z"/></svg>{% endcapture %}
                          {% capture emptystar %}<svg xmlns="http://www.w3.org/2000/svg" class="empty-star" viewBox="0 0 512 489.255" style="max-width:18px;"><path fill="{{ block.settings.rating_color }}" fill-rule="nonzero" d="M278.56 16.223l59.371 139.027 152.968 13.689c6.245.681 11.71 3.801 15.512 8.326 3.833 4.52 5.956 10.445 5.537 16.752l-.082.976c-.935 9.261-5.16 12.903-10.264 17.294-37.836 32.687-75.389 65.812-113.055 98.705l34.123 149.312a23.633 23.633 0 01-3.012 17.825 23.583 23.583 0 01-14.793 10.543l-.595.119c-6.074 1.219-12.464.02-17.65-3.378l-130.623-78.112-131.443 78.587a23.6 23.6 0 01-17.899 2.655 23.638 23.638 0 01-14.546-10.822c-3.92-6.56-3.956-12.294-2.308-19.494l33.652-147.24L8.094 210.267a23.58 23.58 0 01-8.042-16.219 23.627 23.627 0 015.801-17.134c4.122-4.835 10.206-7.722 16.534-8.068l151.666-13.596L234.21 14.405c2.552-6.007 7.329-10.418 12.96-12.691a23.635 23.635 0 0118.094.175c6.963 2.96 10.429 7.604 13.296 14.334zm41.855 153.558L258.487 24.767c-.491-1.157-.925-2.107-1.255-2.526l-.511-.279a1.907 1.907 0 00-1.441-.01 1.847 1.847 0 00-.997.997l-62.714 146.832c-1.549 3.574-4.948 6.219-9.096 6.575L23.585 190.623c-.614.026-.831.258-1.27.62-.718.718-.62 1.973.129 2.629l119.785 104.584a10.912 10.912 0 013.947 11.054l-35.104 153.583c-.3 1.312-.532 2.412-.517 2.923l.264.517c.253.424.671.718 1.136.831.47.114.987.068 1.41-.185l136.894-81.841c3.352-2.071 7.717-2.252 11.332-.088l136.982 81.887c.186.124.429.223.687.264.165.072.367.067.594.036l.145-.036c.49-.109.898-.419 1.136-.796l.041-.041c.238-.382.336-.894.222-1.395l-35.574-155.654c-.847-3.781.341-7.898 3.461-10.63 39.335-34.35 78.54-68.953 118.05-103.086 1.477-1.276 2.707-2.33 2.8-3.141.083-1.053-.574-1.901-1.643-1.994l-158.355-14.251c-4.128-.124-8.002-2.588-9.722-6.632z"/></svg>{% endcapture %}
                          {% assign count = block.settings.rating_count %}  
                          <div class="ratings">
                              {% for i in (1..5) %}
                                  {% assign halfvalue = i | minus:0.5 %}
                                  {% if i <= count %}
                                      {{ fullstar }}
                                  {% elsif halfvalue <= count %}
                                      {{ halfstar }}
                                  {% else %}
                                      {{ emptystar }}
                                  {% endif %}
                              {% endfor %}
                          </div>
                      </div>
                      <div class="review_text">
                          <div class="review_text-title">{{ block.settings.title }}</div>
                          <div class="review_text-name"><span>{{ block.settings.name }}</span><span class="varified">varified</span></div>
                          <div class="review_text-info">{{ block.settings.info }}</div>
                          <div class="review_text-date">{{ block.settings.date }}</div>
                      </div>
                      </a>
                    </div>
                {% endfor %}
            </div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
    </div>
  </div>
</section>

<style>
[data-section-id="{{ section.id }}"] .container {
    padding-top:{{ section.settings.pc_padding_top }}px;
	padding-bottom:{{ section.settings.pc_padding_bottom }}px;
    background:{{ section.settings.background }};
}
@media screen and (max-width: 767px) {
    [data-section-id="{{ section.id }}"] .container {
        padding-top:{{ section.settings.mb_padding_top }}px;
		padding-bottom:{{ section.settings.mb_padding_bottom }}px;
    }
}
[data-section-id="{{ section.id }}"] img {
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
}
[data-section-id="{{ section.id }}"] .swiper-button-next,
[data-section-id="{{ section.id }}"] .swiper-button-prev {
    position: absolute;
    top: 50%;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-top: calc(0px - (var(--swiper-navigation-size) / 2));
    z-index: 10;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #000;
    background: #fff;
    border: 1px solid #ddd;
}
[data-section-id="{{ section.id }}"] .swiper-button-next:after,
[data-section-id="{{ section.id }}"] .swiper-button-prev:after {
    font-size: 20px;
    font-weight: bold;
}
[data-section-id="{{ section.id }}"] .swiper-button-next:after {
    position: relative;
    left: 2px;
}
[data-section-id="{{ section.id }}"] .swiper-button-prev:after {
    position: relative;
    right: 2px;
}
[data-section-id="{{ section.id }}"] .swiper-scrollbar-lock {
    display: none !important;
}
[data-section-id="{{ section.id }}"] .review_star {
    text-align: center;
    margin: 20px 0 0;
    padding: 0 10px;
}
[data-section-id="{{ section.id }}"] .review_star path {
    fill: #ffcd01;
}
[data-section-id="{{ section.id }}"] .review_text {
    text-align: center;
    padding: 0 10px;
}
[data-section-id="{{ section.id }}"] .review_text-title {
    font-size: 16px;
    font-weight: bold;
    color: #000;
}
[data-section-id="{{ section.id }}"] .review_text-info {
    margin: 10px 0;
    font-size: 14px;
    line-height: 1.5;
}
[data-section-id="{{ section.id }}"] .review_text-date {
    color: #333;
    font-size: 14px;
    margin-bottom: 15px;
}

.customer-review-gallery .swiper {
    padding: 15px 10px;
}
.customer-review-gallery .swiper-slide {
    background-color: white;
    box-shadow: 0px 0px 12.8px 0px rgba(0, 0, 0, 0.15);
    border-radius: 10px;
} 

.customer-review-gallery .varified {
    display: inline-flex;
    margin-left: 10px;
    background: #eb8022;
    padding: 4px 10px;
    font-size: 12px;
    border-radius: 4px;
    color: #fff;
    align-items: center;
    justify-content: center;
    line-height: 1;
}
.customer-review-gallery .review_text-name {
    color: #020202;
    font-size: 14px;
}
@media screen and (max-width: 767px) {
    [data-section-id="{{ section.id }}"] .swiper-button-next,
    [data-section-id="{{ section.id }}"] .swiper-button-prev {
        width: 40px;
        height: 40px;
    }
    [data-section-id="{{ section.id }}"] .swiper-button-next:after,
    [data-section-id="{{ section.id }}"] .swiper-button-prev:after {
        font-size: 16px;
    }
}
</style>

<script>
    window.addEventListener("DOMContentLoaded", function () {
        const currentUrl = window.location.href;
        if(currentUrl.indexOf('aaa') != -1){
          $('[data-section-id="{{ section.id }}"]').css('display','block');
        }
      
        var swiper = new Swiper('[data-section-id="{{ section.id }}"] .swiper', {
            spaceBetween: 30,
            breakpoints: {
                320: {
                    slidesPerView: {{ section.settings.per_view_mb }},
                },
                768: {
                    slidesPerView: {{ section.settings.per_view_mb }},
                },
                1080: {
                    slidesPerView: 3,
                },
                1440: {
                    slidesPerView: {{ section.settings.per_view }},
                },
            },
             navigation: {
              nextEl: '[data-section-id="{{ section.id }}"] .swiper-button-next',
              prevEl: '[data-section-id="{{ section.id }}"] .swiper-button-prev',
            },
            on: {
                resize: function(){
                this.update(); //窗口变化时，更新Swiper的一些属性，如宽高等
                }, 
            },
        });
    });                       
</script>

{% schema %}
    {
        "name": "Customer Review Gallery",
        "class":"customer-review-gallery",
        "settings": [
              { "type": "color", "id": "background", "label": "Background", "default":"#ffffff" },
			  { "type": "checkbox", "id": "full_width", "label": "Full Width", "default": false },
              { "type": "header","content":"Option"},
              { "type": "checkbox", "id": "is_center", "label": "居中", "default": false },
              { "type": "text", "id": "title", "label": "Title" },
              { "type": "text", "id": "sub_title", "label": "Sub Title" },
          
              { "type": "range", "id": "per_view", "label": "每行显示几个", "min": 1, "max": 5, "step": 1, "unit": "un", "default": 4},
              { "type": "range", "id": "per_view_mb", "label": "每行显示几个(手机)", "min": 1, "max": 3, "step": 0.1, "unit": "un", "default": 2},
              
              { "type": "header","content":"PC"},
              { "type": "range", "id": "pc_padding_top", "label": "Top Space", "min": 0, "max": 150, "step": 2, "unit": "px", "default": 0 },
              { "type": "range", "id": "pc_padding_bottom", "label": "Bottom Space", "min": 0, "max": 150, "step": 2, "unit": "px", "default": 0 },
              { "type": "header","content":"Mobile"},
              { "type": "range", "id": "mb_padding_top", "label": "Top Space", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
              { "type": "range", "id": "mb_padding_bottom", "label": "Bottom Space", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 }
        ],
        "blocks": [
          {
            "type": "review",
            "name": "Review",
            "settings": [
                { "type": "image_picker", "id":"image", "label":"Image" },
                { "type": "range", "id": "rating_count", "label": "Rating Count", "min": 0, "max": 5, "step": 0.5, "default": 5 },
                { "type": "text", "id": "title", "label": "Title" },
                { "type": "text", "id": "name", "label": "Name" },
                { "type": "text", "id": "info", "label": "Info" },
                { "type": "text", "id": "date", "label": "Date" },
                { "type": "url", "id": "url", "label": "Url" },
            ]
          }
        ],
        "presets": [
            {
                "name": "Customer Review Gallery",
                "category": "Custom"
            }
        ]
    }
{% endschema %}